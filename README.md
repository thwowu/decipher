revised from [decipher](https://github.com/thwowu/decipher/commits?author=dsymbol)
